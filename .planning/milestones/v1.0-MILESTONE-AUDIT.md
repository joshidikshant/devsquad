---
milestone: v1.0
audited: 2026-02-19T15:00:00Z
status: passed
scores:
  requirements: 17/18
  phases: 4/4
  integration: 10/12
  flows: 3/5
gaps:
  requirements:
    - id: "WFLO-04"
      status: "deferred"
      phase: "04"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "deferred"
      evidence: "Explicitly deferred to v2 in REQUIREMENTS.md under v2 Requirements section. No implementation exists. Phase 4 VERIFICATION.md acknowledges this as out-of-scope."
  integration:
    - id: "BREAK-1"
      severity: high
      description: "lib-workflow.sh reads .status from git-health.sh --json output but that field does not exist. Causes workflow_validate to always report failure even on healthy repos."
      files: ["plugin/skills/workflow-orchestration/scripts/lib-workflow.sh:96-101", "plugin/skills/git-health/scripts/git-health.sh:138-149"]
      affected_requirements: ["WFLO-01", "ORCH-04"]
      fix: "Replace jq '.status // \"unknown\"' with jq '.total_issues // -1' and check if > 0"
    - id: "BREAK-2"
      severity: medium
      description: "feature-workflow.json uses CWD-relative paths (plugin/skills/...) for bash invocations. Fails if run-workflow.sh is not invoked from repo root."
      files: ["plugin/skills/workflow-orchestration/templates/feature-workflow.json:15-22"]
      affected_requirements: ["WFLO-01", "CGEN-01", "ORCH-01"]
      fix: "Change relative paths to absolute using $PLUGIN_ROOT or document CWD requirement"
    - id: "DEAD-CODE-1"
      severity: low
      description: "Bash tool handler in pre-tool-use.sh is unreachable — hooks.json matcher is 'Read|WebSearch' only."
      files: ["plugin/hooks/hooks.json:36", "plugin/hooks/scripts/pre-tool-use.sh:91-106"]
      affected_requirements: []
      fix: "Add Bash to hooks.json matcher or remove dead case block"
tech_debt:
  - phase: 04-workflow-orchestration
    items:
      - "lib-workflow.sh assumes STATE_DIR exported by caller — fragile if called from other contexts"
      - "generate-skill.sh does not set DEVSQUAD_HOOK_DEPTH at script top-level (inconsistent with run-workflow.sh)"
  - phase: 03-enforcement-and-routing-skills
    items:
      - "macOS BSD sed incompatibility with GNU idioms — fixed with awk/perl workaround (documented)"
  - phase: 01-delegation-advisor
    items:
      - "Bash tool delegation advisory is dead code (hooks.json matcher excludes Bash tool calls)"
---

# Milestone v1.0 Audit Report

**Project:** DevSquad Phase 2 Improvements
**Milestone:** v1.0
**Audited:** 2026-02-19
**Status:** gaps_found — 2 integration breaks require fixes before shipping

---

## Executive Summary

All 4 phases completed successfully. 17/18 requirements implemented (WFLO-04 explicitly deferred to v2). Phase verifications passed for phases 1-3. Phase 4 verification flagged WFLO-04 as gaps_found (the v2 deferral).

Cross-phase integration check found **2 runtime breaks**:
1. **High severity:** `workflow_validate` always reports unhealthy repos — schema mismatch between what it reads from `git-health.sh --json` and what that output actually contains.
2. **Medium severity:** `feature-workflow.json` uses CWD-relative paths — breaks when invoked from any directory other than repo root.

---

## Phase Verification Summary

| Phase | Name | Plans | Status | Score |
|-------|------|-------|--------|-------|
| 01 | Delegation Advisor | 3/3 | ✅ PASSED | All 4 DELEG requirements |
| 02 | Git Health Check | 2/2 | ✅ passed | 22/22 must-haves |
| 03 | Code Generation | 3/3 | ✅ passed | 19/19 must-haves |
| 04 | Workflow Orchestration | 3/3 | ⚠ gaps_found | 4/5 (WFLO-04 deferred) |

---

## Requirements Coverage (3-Source Cross-Reference)

| Requirement | Phase | VERIFICATION.md | SUMMARY | REQUIREMENTS.md checkbox | Final Status |
|-------------|-------|-----------------|---------|--------------------------|--------------|
| DELEG-01 | 1 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| DELEG-02 | 1 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| DELEG-03 | 1 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| DELEG-04 | 1 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| GHLT-01 | 2 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| GHLT-02 | 2 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| GHLT-03 | 2 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| GHLT-04 | 2 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| GHLT-05 | 2 | SATISFIED | n/a | `[ ]` (not updated) | **satisfied** — update checkbox |
| CGEN-01 | 3 | VERIFIED | n/a | `[x]` | **satisfied** |
| CGEN-02 | 3 | VERIFIED | n/a | `[x]` | **satisfied** |
| CGEN-03 | 3 | VERIFIED | n/a | `[x]` | **satisfied** |
| CGEN-04 | 3 | VERIFIED | n/a | `[x]` | **satisfied** |
| CGEN-05 | 3 | VERIFIED | n/a | `[x]` | **satisfied** |
| WFLO-01 | 4 | VERIFIED (partially) | n/a | `[x]` | **partial** — BREAK-2 (CWD paths) |
| WFLO-02 | 4 | VERIFIED | n/a | `[x]` | **satisfied** |
| WFLO-03 | 4 | VERIFIED | n/a | `[x]` | **satisfied** |
| WFLO-04 | 4 | deferred | n/a | `[ ]` | **deferred** — v2 requirement |

**Score: 17/18 implemented (WFLO-04 deferred), 15/17 fully wired (WFLO-01 and ORCH-04 have integration breaks)**

---

## Integration Findings

### Break 1 — High: Schema Mismatch in workflow_validate (always fails)

**File:** `plugin/skills/workflow-orchestration/scripts/lib-workflow.sh:96-101`

`workflow_validate` reads `.status` from `git-health.sh --json` output. That output never emits a `.status` field — it emits `total_issues` (integer). `jq '.status // "unknown"'` always returns `"unknown"`. Since `"unknown" != "healthy"`, post-workflow validation always reports FAILED even on a clean repo.

**Fix:**
```bash
# Replace (lib-workflow.sh ~line 98):
health_status=$(echo "$health_json" | jq -r '.status // "unknown"' 2>/dev/null || echo "unknown")
if [[ "$health_status" != "healthy" && "$health_status" != "ok" ]]; then

# With:
total_issues=$(echo "$health_json" | jq -r '.total_issues // -1' 2>/dev/null || echo "-1")
if [[ "$total_issues" -gt 0 ]]; then
```

**Affected:** WFLO-01, ORCH-04

### Break 2 — Medium: CWD-Relative Paths in feature-workflow.json

**File:** `plugin/skills/workflow-orchestration/templates/feature-workflow.json`

Steps `generate-skill` and `validate` use `plugin/skills/...` relative paths. These only resolve when `run-workflow.sh` is invoked from the repo root. Any other invocation context breaks both steps.

**Fix:** Replace with absolute paths using `$PLUGIN_ROOT`:
```json
"args": "$PLUGIN_ROOT/skills/code-generation/scripts/generate-skill.sh ..."
```

Or document in SKILL.md that the command must be invoked from repo root.

**Affected:** WFLO-01, CGEN-01, ORCH-01

### Dead Code — Low: Bash Tool Handler in pre-tool-use.sh Unreachable

**File:** `plugin/hooks/hooks.json:36` — matcher `"Read|WebSearch"` excludes `Bash`

`pre-tool-use.sh` has a `Bash)` case block (lines 91-106) that handles test-command delegation advisories. It is never reached. Not a runtime break — DELEG requirements are unaffected (they only cover Read tool calls).

**Affected:** None of the milestone requirements

---

## E2E Flow Assessment

| Flow | Steps | Status | Break Point |
|------|-------|--------|-------------|
| Read-heavy session → delegation advisory | User reads 3+ files → hook fires → Gemini suggestion appears | ✅ Complete | — |
| Git repo health check | `/devsquad:git-health` → runs all 3 checks → human + JSON output | ✅ Complete | — |
| Skill generation | `/devsquad:generate "description"` → Gemini research → Codex draft → y/N/e → files written | ✅ Complete | — |
| Workflow dry-run | `run-workflow.sh --dry-run` → 4 steps printed with [DRY RUN] prefix | ✅ Complete | — |
| Workflow with validation | Workflow completes → `workflow_validate` called → always reports FAILED | ⚠ Broken | BREAK-1: `.status` field missing |

---

## Known Gaps to Record

### WFLO-04 (Deferred to v2)
**Description:** Cleanup workflow that finds and auto-fixes repository issues
**Status:** Explicitly deferred — listed under "v2 Requirements" in REQUIREMENTS.md
**Decision:** Accepted as known gap for v1.0

---

## Recommended Path

These 2 fixes are small (single-line changes) and should be applied before shipping:

1. **Fix BREAK-1** (lib-workflow.sh: `.status` → `total_issues`) — 2 lines
2. **Fix BREAK-2** (feature-workflow.json: relative → absolute paths) — 2 lines

After fixes, re-run: `bash plugin/skills/workflow-orchestration/scripts/run-workflow.sh --dry-run --workflow plugin/skills/workflow-orchestration/templates/feature-workflow.json`

Then proceed with `/gsd:complete-milestone`.

---

*Audit generated: 2026-02-19*
*Auditor: gsd-integration-checker + orchestrator*
